seed: 42 #Global RNG seed

training:
  total_timesteps: 10000
  fee_rate: 0.0
  # New parameters for iterative training
  max_iterations: 10
  improvement_threshold: 0.20
  additional_timesteps: 1000
  n_stagnant_loops: 10
  verbose: 0  # 0 for minimal output, 1 for normal, 2 for detailed
  # Evaluation metric configuration
  evaluation:
    metric: "return"  # Options: "return" (total return percentage), "hit_rate" (percentage of profitable trades), or "prediction_accuracy" (percentage of correct price direction predictions)
  # Early stopping based on loss convergence (more stable than profit-based)
  early_stopping:
    enabled: true           # Use loss-based early stopping (recommended)
    patience: 5             # Stop if no loss improvement for N iterations
    min_delta: 0.001        # Minimum loss decrease to count as improvement

data:
  train_ratio: 0.6
  validation_ratio: 0.2
  test_ratio: 0.2
  market_hours_only: false  # Filter data to only include NYSE market hours (9:30 AM to 4:00 PM ET, Monday to Friday)

normalization:
  scaler_type: "robust"  # Options: "robust" (recommended), "minmax", "quantile"
  # robust: Uses median and IQR, handles outliers well, applies tanh for soft clipping to [-1,1]
  # minmax: Standard min-max scaling to [-1,1], sensitive to outliers
  # quantile: Maps to uniform distribution then rescales to [-1,1], best for heavy-tailed data

indicators:
  supertrend:
    enabled: true
    length: 20
    multiplier: 4
    smooth_periods: 3
    lookback_periods: 2
  rsi:
    enabled: true
    length: 14
  cci:
    enabled: true
    length: 20
  adx:
    enabled: true
    length: 14
  adx_pos:
    enabled: true
  adx_neg:
    enabled: true
  stoch_k:
    enabled: true
    length: 14
  stoch_d:
    enabled: true
    length: 3
  macd:
    enabled: true
    fast: 12
    slow: 26
    signal: 9
  roc:
    enabled: true
    length: 10
  williams_r:
    enabled: true
    length: 14
  sma:
    enabled: true
    length: 20
  ema:
    enabled: true
    length: 20
  disparity:
    enabled: true
  atr:
    enabled: true
    length: 14
  obv:
    enabled: true
  cmf:
    enabled: true
    length: 20
  psar:
    enabled: true
    af: 0.02
    max_af: 0.2
  volume:
    enabled: true
    ma_length: 20
  vwap:
    enabled: true
  day_of_week:
    enabled: true
  minutes_since_open:
    enabled: true
  z_score:
    enabled: false
    length: 50  # Lookback period for calculating rolling mean and std
  rrcf_anomaly:
    enabled: false
    window_size: 100  # Size of sliding window for RRCF calculation
    num_trees: 64     # Number of trees in the forest (reduced from 40 for speed)
    tree_size: 256    # Maximum size of each tree (reduced from 256 for speed)
    feature_cols: ["close"]  # Features to use for anomaly detection
    random_seed: 42   # Random seed for reproducibility

environment:
  initial_balance: 10000.0
  position_size: 1  # Number of NQ futures contracts to trade (default: 1)
  transaction_cost: 2.50  # Transaction cost per contract per side in dollars (realistic: $2-3 for futures)

model:
  ent_coef: 0.01  # Increased from 0.0001 for better exploration (recommended: 0.01-0.1)
  ent_coef_decay: true  # Enable entropy decay during training
  final_ent_coef: 0.001  # Final entropy coefficient after decay
  learning_rate: 0.0029977835304081614
  n_steps: 562
  batch_size: 22
  gamma: 0.95
  gae_lambda: 0.95
  use_lr_decay: true

# Sequence model configuration (LSTM for temporal context)
sequence_model:
  enabled: true  # Use RecurrentPPO with LSTM instead of standard PPO
  lstm_hidden_size: 128  # Size of LSTM hidden state
  n_lstm_layers: 1  # Number of LSTM layers (1-2 recommended)
  shared_lstm: true  # Whether actor and critic share the LSTM
  reset_on_new_day: false  # Reset LSTM state at start of each trading day
  device: "auto"  # Device for training: "auto", "cuda", "mps", or "cpu"

# Risk management configuration for trade.py
risk_management:
  # Enable/disable risk management features
  enabled: false  # Master switch to enable/disable all risk management
  
  # Daily risk limit configuration
  daily_risk_limit:
    enabled: false  # Enable/disable daily risk limit
    max_daily_loss: 3000.0  # Maximum dollar loss allowed per trading day
    daily_take_profit: 2000.0  # Maximum profit target for the day, stop trading when reached
  
  # Stop loss configuration
  stop_loss:
    enabled: false 
    mode: "percentage"  # Options: "percentage", "atr"
    percentage: 17  # Stop loss as percentage of portfolio value (used when mode="percentage")
    atr_multiplier: 5.0  # Stop loss as multiple of ATR (used when mode="atr")
  
  # Take profit configuration
  take_profit:
    enabled: true
    mode: "percentage"  # Options: "percentage", "atr"
    percentage: 20  # Take profit as percentage of portfolio value (used when mode="percentage")
    atr_multiplier: 5.0  # Take profit as multiple of ATR (used when mode="atr")
  
  # Trailing stop loss configuration
  trailing_stop:
    enabled: false
    percentage: 1.0  # Trailing stop as percentage of highest/lowest price
  
  # Position sizing configuration
  position_sizing:
    enabled: false
    size_multiplier: 1.0  # Position size as a multiplier (1.0 = 100% of available capital)
    max_risk_per_trade_percentage: 1.0  # Maximum risk per trade as percentage of portfolio

# Walk-forward testing configuration
walk_forward:
  enabled: true
  window_size: 240
  step_size: 30
  parallel_processing:
    enabled: false  # Disabled - MPS doesn't work well with multiprocessing
    n_processes: 0  # Auto-detect number of CPU cores
    max_workers: 0  # Use all available workers

# Hyperparameter tuning configuration
hyperparameter_tuning:
  enabled: false
  n_trials: 30
  parallel_processing:
    enabled: false  # Disable parallel processing for hyperparameter tuning
    n_jobs: 1      # Use single process for tuning
  # Parameters to tune (these are the search spaces)
  parameters:
    learning_rate: 
      min: 0.00001
      max: 0.001
      log: true
    n_steps:
      min: 500
      max: 2000
      log: true
    ent_coef:
      min: 0.00001
      max: 0.5
      log: true
    batch_size:
      min: 8
      max: 128
      log: true
    # Fixed values for gamma and gae_lambda
    gamma: 0.995  # Fixed value instead of search range
    gae_lambda: 0.95  # Fixed value instead of search range
    # LSTM hyperparameters (only used when sequence_model.enabled is true)
    lstm_hidden_size:
      choices: [64, 128, 256, 512]
    n_lstm_layers:
      min: 1
      max: 2
